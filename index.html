<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Poison Roulette - Multi-Stat Edition</title>
    <link rel="stylesheet" href="styles.css" />
  </head>
  <body>
    <div class="game-container">
      <h1>‚ò†Ô∏è Poison Roulette</h1>

      <div class="turn-order">
        <h3>Current Turn</h3>
        <div id="turn-order-display"></div>
      </div>

      <div class="players-grid" id="players-grid">
        <!-- Players will be generated here -->
      </div>

      <div class="stats-table">
        <h3>üìä Player Statistics</h3>
        <div class="stats-grid" id="stats-grid">
          <div class="stats-header">Player</div>
          <div class="stats-header">üîß Sabotage</div>
          <div class="stats-header">‚ò†Ô∏è Toxin</div>
          <!-- Player stats will be generated here -->
        </div>
      </div>

      <div class="drinks-container" id="drinks-container">
        <!-- Drinks will be generated here -->
      </div>

      <div class="controls">
        <button
          class="btn"
          id="drink-btn"
          onclick="drinkSelected()"
          style="display: none"
        >
          Select a Drink
        </button>
        <button
          class="btn"
          id="action-btn"
          onclick="openActionModal()"
          style="display: none"
        >
          ACTIONS
        </button>
        <button
          class="btn"
          id="new-game-btn"
          onclick="startNewGame()"
          style="display: none"
        >
          New Game
        </button>
      </div>

      <div class="winner-announcement" id="winner-announcement">
        <div id="winner-text"></div>
      </div>

      <div class="toast-container" id="toast-container">
        <!-- Toast notifications will appear here -->
      </div>

      <!-- Drink Outcome Modal -->
      <div id="outcome-modal" class="drink-outcome-modal">
        <div class="outcome-content" id="outcome-content">
          <div class="outcome-drink" id="outcome-drink">
            <div class="drink-liquid" id="outcome-liquid"></div>
          </div>
          <div class="outcome-title" id="outcome-title"></div>
          <div class="outcome-description" id="outcome-description"></div>
          <div class="outcome-effects" id="outcome-effects"></div>
          <button class="continue-btn" onclick="closeOutcomeModal()">
            Continue
          </button>
        </div>
      </div>
    </div>

    <!-- Action Selection Modal -->
    <div id="action-modal" class="modal">
      <div class="modal-content">
        <span class="close" onclick="closeActionModal()">&times;</span>
        <h3>üéØ Choose Your Action</h3>
        <div class="action-buttons" id="action-buttons">
          <!-- Action buttons will be generated here -->
        </div>
      </div>
    </div>

    <!-- Help Modal - UPDATED to use dynamic content -->
    <div id="help-modal" class="modal">
      <div class="modal-content">
        <span class="close" onclick="closeHelpModal()">&times;</span>
        <div class="drink-legend">
          <div class="legend-title">Drink Effects Guide</div>

          <!-- Dynamic content will be populated here -->
          <div id="dynamic-drink-effects">
            <!-- This will be filled by JavaScript -->
          </div>

          <div
            style="
              margin-top: 20px;
              padding-top: 15px;
              border-top: 1px solid rgba(255, 255, 255, 0.2);
              font-size: 0.85em;
            "
          >
            <strong>Stats Explained:</strong><br />
            ‚ù§Ô∏è Health | üîß Sabotage (action currency) | ‚ò†Ô∏è Toxin (cumulative
            damage)
          </div>

          <div style="margin-top: 15px; font-size: 0.85em">
            <strong>Actions:</strong> Duplicate, Neutralize, Eliminate, Analyze,
            Spike, Poison, or Deadly Poison drinks using üîß Sabotage points
          </div>
        </div>
      </div>
    </div>

    <button class="help-btn" onclick="openHelpModal()">?</button>

    <!-- Load game configuration and logic -->
    <script src="config.js"></script>
    <script src="game.js"></script>
    <script>
      // Populate help modal with dynamic content when page loads
      document.addEventListener("DOMContentLoaded", function () {
        populateHelpModal();
      });

      function populateHelpModal() {
        const container = document.getElementById("dynamic-drink-effects");
        const drinkColors = {
          blue: "#74b9ff",
          green: "#00b894",
          yellow: "#fdcb6e",
          red: "#ff6b6b",
          purple: "#a29bfe",
          black: "#636e72",
        };

        const drinkEmojis = {
          blue: "üîµ",
          green: "üü¢",
          yellow: "üü°",
          red: "üî¥",
          purple: "üü£",
          black: "‚ö´",
        };

        DRINK_COLORS.forEach((color) => {
          const drinkEffect = DRINK_EFFECTS[color];
          const row = document.createElement("div");
          row.className = "legend-row";

          const colorStyle = `color: ${drinkColors[color]}`;
          const tooltipText = generateDrinkTooltipText(color);

          row.innerHTML = `
            <span style="${colorStyle}">${drinkEmojis[color]} ${drinkEffect.name}:</span> 
            ${tooltipText}
          `;

          container.appendChild(row);
        });
      }
    </script>
  </body>
</html>
